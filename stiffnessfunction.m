function [ k ] = stiffnessfunction(rleft,rright,zbot,ztop,mat,kc)
%STIFFNESSFUNCTION Summary of this function goes here
%   Detailed explanation goes here
% the code has to be modified to include thermal conductivity

j=0.25*(rright-rleft)*(ztop-zbot);
%j=1;
k=j^2*kc(mat)*[ (2*((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064))/((rleft - rright)*(zbot - ztop)^3) + ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) + ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) + (2*((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032))/((rleft - rright)*(zbot - ztop)^3) + ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                  (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) - ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) - ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)) - ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032))/((rleft - rright)*(zbot - ztop)^3) - (2*((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064))/((rleft - rright)*(zbot - ztop)^3) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop));
                                                                                                                                  (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) - ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) - ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)) - ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3), ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256))/((rleft - rright)*(zbot - ztop)^3) + ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) + (2*((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008))/((rleft - rright)*(zbot - ztop)^3) + ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) + ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008))/((rleft - rright)*(zbot - ztop)^3) - (2*((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256))/((rleft - rright)*(zbot - ztop)^3) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008))/((rleft - rright)*(zbot - ztop)^3) - (2*((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256))/((rleft - rright)*(zbot - ztop)^3) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)), ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256))/((rleft - rright)*(zbot - ztop)^3) + ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) + (2*((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008))/((rleft - rright)*(zbot - ztop)^3) + ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) + ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                  (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) - ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) - ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)) - ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032))/((rleft - rright)*(zbot - ztop)^3) - (2*((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064))/((rleft - rright)*(zbot - ztop)^3) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)^3*(zbot - ztop)) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3) - (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)^3*(zbot - ztop)),                                                                                                                                  (2*((1268963446790561*rleft)/9007199254740992 + (1183959014092525*rright)/2251799813685248))/((rleft - rright)*(zbot - ztop)^3) - ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) - ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) - ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop)) - ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + (2*((1183959014092525*rleft)/2251799813685248 + (1268963446790561*rright)/9007199254740992))/((rleft - rright)*(zbot - ztop)^3), (2*((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064))/((rleft - rright)*(zbot - ztop)^3) + ((12250429805558914140084685456713*rleft)/324518553658426726783156020576256 + (11429806612225499344129300958325*rright)/81129638414606681695789005144064)/((rleft - rright)^3*(zbot - ztop)) + ((11429806612225499344129300958325*rleft)/81129638414606681695789005144064 + (12250429805558914140084685456713*rright)/324518553658426726783156020576256)/((rleft - rright)^3*(zbot - ztop)) + ((21328309498756138882721295919755*rleft)/40564819207303340847894502572032 + (19899583672227954379472310711375*rright)/10141204801825835211973625643008)/((rleft - rright)^3*(zbot - ztop)) + (2*((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032))/((rleft - rright)*(zbot - ztop)^3) + ((19899583672227954379472310711375*rleft)/10141204801825835211973625643008 + (21328309498756138882721295919755*rright)/40564819207303340847894502572032)/((rleft - rright)^3*(zbot - ztop))];
                        
%k=sum(sum(k))/sum(diag(k))*[k(1,1) 0 0 0; 0 k(2,2) 0 0; 0 0 k(3,3) 0; 0 0 0 k(4,4)];
end

